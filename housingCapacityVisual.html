<!DOCTYPE html>
<html>
  <head>
    <style>
      html, body {
        height: 100%;
      }
      button {
      	margin-bottom: 15px;
      	background-color: blue;
      	color: white;
      }
      #map {
        height: 80%;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  </head>
  <body>

  	<h1>Map for Number of Classrooms at each Rutgers building for Spring 2016</h1>
  	<button id="btn" type="button" onclick="toggle_visibility();">Get Heat Map</button>

<!--<iframe id="heat" style="display:none" width="100%" height="80%" scrolling="no" frameborder="no" src="https://www.google.com/fusiontables/embedviz?q=select+col4%2C+col2+from+1SwQEfcxlCbjkMbk661EheEyNJf_6Obm_zryBXvBy+limit+1000&amp;viz=HEATMAP&amp;h=true&amp;lat=40.522214830727805&amp;lng=-74.43783323783873&amp;t=1&amp;z=12&amp;l=col4&amp;y=2&amp;tmplt=2&amp;hmd=true&amp;hmg=%2366ff0000%2C%2393ff00ff%2C%23c1ff00ff%2C%23eeff00ff%2C%23f4e300ff%2C%23f4e300ff%2C%23f9c600ff%2C%23ffaa00ff%2C%23ff7100ff%2C%23ff3900ff%2C%23ff0000ff&amp;hmo=0.55&amp;hmr=27&amp;hmw=2&amp;hml=ONE_COL_LAT_LNG"></iframe> -->

<iframe id="heat" style="display:none" width="100%" height="80%" scrolling="no" frameborder="no" src="https://www.google.com/fusiontables/embedviz?q=select+col4%2C+col2+from+1qSs0v8kDg6LSbQhhVe7gWMO-t4_7Q-EUdNKJMyyr+limit+1000&amp;viz=HEATMAP&amp;h=true&amp;lat=40.5223&amp;lng=-74.43763986499021&amp;t=1&amp;z=13&amp;l=col4&amp;y=2&amp;tmplt=2&amp;hmd=true&amp;hmg=%2366ff0000%2C%2393ff00ff%2C%23c1ff00ff%2C%23eeff00ff%2C%23f4e300ff%2C%23f4e300ff%2C%23f9c600ff%2C%23ffaa00ff%2C%23ff7100ff%2C%23ff3900ff%2C%23ff0000ff&amp;hmo=0.74&amp;hmr=21&amp;hmw=2&amp;hml=ONE_COL_LAT_LNG"></iframe>
<div id="map" style="display:block" width="100%"></div>
	<script>
	function toggle_visibility() {

       var e = document.getElementById('heat');
       var f = document.getElementById('map')
       if(e.style.display == 'block')
          e.style.display = 'none';
       else
          e.style.display = 'block';
       if(f.style.display == 'block')
          f.style.display = 'none';
       else
          f.style.display = 'block';
       if(f.style.display == 'block')
          document.getElementById('btn').innerHTML = "Get Heat Map"
       else
          document.getElementById('btn').innerHTML = "Get Circle Map"
    }

var infoWindow = new google.maps.InfoWindow();
var citymap = {};
var mapCanvas = document.getElementById('map');
var mapOptions = {
          center: new google.maps.LatLng(40.51, -74.45),
          zoom: 14,
          mapTypeId: google.maps.MapTypeId.ROADMAP
}
map = new google.maps.Map(mapCanvas, mapOptions);

function processData(allText) {
    var allTextLines = allText.split(/\r\n|\n/);
    for (var i = 0; i < allTextLines.length; i++) {
      var elems = allTextLines[i].split(',');
      var latlng = {lat: Number(elems[0]), lng: Number(elems[1])};
      citymap[elems[3]] = {center: latlng, population: Number(elems[2])};
    };
    for (var city in citymap) {
      
      var cityCircle = new google.maps.Circle({
          strokeColor: '#FF0000',
        strokeOpacity: 0.9,
        strokeWeight: 1,
        fillColor: '#FF0000',
        fillOpacity: 0.45,
        map: map,
        clickable: true, 
        center: citymap[city].center,
        radius: Math.sqrt(citymap[city].population) * 5
      });

      google.maps.event.addListener(cityCircle, 'click', (function(cityCircle, city) {
              return function() {
                infoWindow.setPosition(citymap[city].center);
                infoWindow.setContent(city + ": " + citymap[city].population);
                infoWindow.open(map, cityCircle);
              }
      })(cityCircle, city));
    }
}

processData(
"40.5039047,-74.4483754,330,Frelinghuysen Hall\n40.5047782,-74.4505388,330,Hardenbergh Hall\n40.5074358,-74.4616037,110,Hegeman Hall\n40.5074358,-74.4616037,46,Leupp Hall\n40.5023842,-74.451037,330,Mettler Hall\n40.5074358,-74.4616037,70,Pell Hall\n40.5028865,-74.4515451,200,Stonier Hall\n40.502335,-74.4509813,200,Tinsley Hall\n40.4967693,-74.447636,660,University Center at Easton Avenue Apartments\n40.5074358,-74.4616037,60,Wessels Hall\n40.5074358,-74.4616037,350,Clothier Hall\n40.501882,-74.4502033,250,Brett Hall\n40.5047844,-74.4505507,325,Campbell Hall\n40.5026272,-74.4512844,188,Demarest Hall\n40.5214544,-74.4532532,200,Allen Hall\n40.5220779,-74.4538181,200,Barr Hall\n40.5222955,-74.4546121,500,Busch Engineering, Science and Technology (B.E.S.T) Hall\n40.5258209,-74.4596243,180,Crosby Suites\n40.5259849,-74.4590805,340,Davidson Hall\n40.5255353,-74.458938,180,Judson Suites\n40.5208897,-74.4536685,200,Mattia Hall\n40.524863,-74.45882,200,McCormick Suites\n40.5222129,-74.4559203,200,Metzger Hall\n40.5250133,-74.4553729,180,Morrow Suites\n40.5283246,-74.4652514,188,Nichols Apartments\n40.5254264,-74.467718,520,Richardson Apartments\n40.5194536,-74.4550312,636,Silvers Apartments\n40.5250189,-74.4553348,180,Thomas Suites\n40.5250264,-74.4552839,180,Winkler Suites\n40.5198519,-74.4540406,130,Marvin Apartments\n40.5246147,-74.4611957,380,Buell Apartments\n40.527754,-74.465364,82,Johnson Apartments\n40.4718737,-74.4355948,38,Helyar House\n40.4814421,-74.427251,280,Henderson Apartments\n40.4838278,-74.4389223,242,Jameson Hall\n40.4836696,-74.4306334,245,Katzenbach Hall\n40.4813856,-74.4304105,245,Lippincott Hall\n40.486322,-74.431708,485,New Gibbons Hall\n40.4783634,-74.4313449,992,Newell Apartments\n40.4801283,-74.432098,235,Nicholas Hall\n40.4852779,-74.4323167,92,Old Gibbons Hall\n40.4784696,-74.4305345,175,Perry Hall\n40.4784446,-74.4320106,384,Starkey Apartments\n40.4784446,-74.4320106,225,Voorhees Hall\n40.4800653,-74.4322521,120,Woodbury Bunting-Cobb Hall\n40.5239819,-74.4355071,1600,Livingston Apartments\n40.5244162,-74.4363092,350,Lynton Towers, North\n40.5244162,-74.4363092,365,Lynton Towers, South\n40.5196426,-74.435472,500,Quad I\n40.5199896,-74.4333785,500,Quad II\n40.5206204,-74.4327017,500,Quad III\n");
    </script>
</body>
</html>