<!DOCTYPE html>
    <html>
    <header>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    </header>
    <body>

    <h1 id = "time" style = "font-size:450%; text-align: center; font-family: 'Lucida Console', Monaco, monospace">Videos</h1>

    <div id = "choice"></div>
	
	<script type="text/javascript">

	var d  = new Date();
	var month = new Array();

	month[0] = "January";
	month[1] = "February";
	month[2] = "March";
	month[3] = "April";
	month[4] = "May";
	month[5] = "June";
	month[6] = "July";
	month[7] = "August";
	month[8] = "September";
	month[9] = "October";
	month[10] = "November";
	month[11] = "December";

	function nth(d) {
	 	if(d>3 && d<21) return 'th';
	  	switch (d % 10) {
	        case 1:  return "st";
	        case 2:  return "nd";
	        case 3:  return "rd";
		    default: return "th";
	    } 
	}

    getVideoLink('Sankat Mochan Mahabali Hanumaan');
    getVideoLink('chakravartin ashoka samrat');
    getVideoLink('Taarak Mehta Ka Ooltah Chashmah');

    function getVideoLink(showname){
        showname = showname.replace(/\s/g,'-').toLowerCase();
        var show_episode_link = "https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%20%3D%20%22http%3A%2F%2Fwww.desiserials.tv%2F"+showname+"-"+d.getDate()+nth(d.getDate())+"-"+month[d.getMonth()]+"-"+d.getFullYear()+"-watch-online-episode-hd%2F%22%20and%20xpath%3D%22%2F%2Fp%2Fa%22&format=json&diagnostics=true&callback=";

        $.ajax({
            type: 'GET', 
            url: show_episode_link, 
            dataType: 'json',
            success: function(data) { 
                console.log(data);
                var part1 = data["query"]["results"]["a"][2]["href"];
                var part2 = data["query"]["results"]["a"][3]["href"];
                var vlink = "https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%20%3D%20%22" + encodeURI(part1) +  "%22%20and%20xpath%3D%22%2F%2Fiframe%22&format=json&diagnostics=true&callback=";
                var vlink2 = "https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%20%3D%20%22" + encodeURI(part2) +  "%22%20and%20xpath%3D%22%2F%2Fiframe%22&format=json&diagnostics=true&callback=";
                getFrame(vlink);
                getFrame(vlink2);
            }
        });
    }

	function getFrame(link){
		$.ajax({
            type: 'GET', 
            url: link, 
            dataType: 'json',
            success: function(data) { 
                var frames = data["query"]["results"]["iframe"];
                console.log(frames);
                if(frames["src"].includes("dailymotion")){
                	var fr_link = frames["src"].replace('//','https://')
					$("#choice").append("<iframe src=\"" + fr_link + "\" allowfullscreen=\"allowfullscreen\"></iframe><br>");
                }
            }
        });
	}

	</script>



    </body>
    </html>